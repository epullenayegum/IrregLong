<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>R package IrregLong for analysing longitudinal data with irregular observation times • IrregLong</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="R package IrregLong for analysing longitudinal data with irregular observation times">
<meta name="description" content="
This package contains functions to help with analysis of longitudinal data featuring irregular observation times, where the observation times may be associated with the outcome process. There are functions to quantify the degree of irregularity, fit inverse-intensity weighted GEEs (Lin H, Scharfstein DO, Rosenheck RA (2004) &lt;doi:10.1111/j.1467-9868.2004.b5543.x&gt;), perform multiple outputation (Pullenayegum EM (2016) &lt;doi:10.1002/sim.6829&gt;) and fit semi-parametric joint models (Liang Y (2009) &lt;doi: 10.1111/j.1541-0420.2008.01104.x&gt;)
">
<meta property="og:description" content="
This package contains functions to help with analysis of longitudinal data featuring irregular observation times, where the observation times may be associated with the outcome process. There are functions to quantify the degree of irregularity, fit inverse-intensity weighted GEEs (Lin H, Scharfstein DO, Rosenheck RA (2004) &lt;doi:10.1111/j.1467-9868.2004.b5543.x&gt;), perform multiple outputation (Pullenayegum EM (2016) &lt;doi:10.1002/sim.6829&gt;) and fit semi-parametric joint models (Liang Y (2009) &lt;doi: 10.1111/j.1541-0420.2008.01104.x&gt;)
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">IrregLong</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Irreglong-vignette.html">Analysis of longitudinal data with irregular observation times</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="irreglong">IrregLong<a class="anchor" aria-label="anchor" href="#irreglong"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of the IrregLong package is to provide functions for handling longitudinal data subject to irregular observation.</p>
<div class="section level2">
<h2 id="why-might-you-need-this-package">Why might you need this package?<a class="anchor" aria-label="anchor" href="#why-might-you-need-this-package"></a>
</h2>
<p>If you have longitudinal data where the assessment times vary among subjects, you need to ask why they vary, whether time assessment times are associated with your outcome, and what the appropriate method of analysis is.</p>
<p>For example, suppose you were estimating the rate of growth among newborns and had data collected as part of usual care. Typically, weight and length are measured at every clinical encounter, which would include birth and 2-month vaccinations. However, newborns who are slow to regain their birthweight will be seen more frequently. Consequently, observations corresponding to newborns who are growing slowly are over-represented in your data, which will lead to under-estimation of the rate of growth unless you account for the informative nature of the visit process.</p>
<p>The IrregLong package will help you assess how irregular the assessment times are, whether there are measured predictors of assessment times, and to analyse your data accounting for irregularity.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of IrregLong through Github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"epullenayegum/Irreglong"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examining-the-extent-of-irregularity">Examining the extent of irregularity<a class="anchor" aria-label="anchor" href="#examining-the-extent-of-irregularity"></a>
</h2>
<p>Before fitting any models, it is wise to examine the extent of irregularity in the data. In many cases, a sensible question is ``How closely does this data resemble repeated measures data?’’ A quick visual way of answering this question is through an abacus plot:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/abacus.plot.html">abacus.plot</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">59</span>,time<span class="op">=</span><span class="st">"time"</span>,id<span class="op">=</span><span class="st">"Subject"</span>,data<span class="op">=</span><span class="va">data</span>,tmin<span class="op">=</span><span class="fl">0</span>,tmax<span class="op">=</span><span class="fl">16</span><span class="op">*</span><span class="fl">24</span>,</span>
<span> xlab.abacus<span class="op">=</span><span class="st">"Time in hours"</span>,pch<span class="op">=</span><span class="fl">16</span>,col.abacus<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="is-the-irregularity-informative">Is the irregularity informative?<a class="anchor" aria-label="anchor" href="#is-the-irregularity-informative"></a>
</h2>
<p>If you decide that the extent of irregularity is sufficient to warrant considering the irregularity in your analysis, the next question to consider is whether the irregularity is informative. Irregularity that is purely random (termed “Assessment Completely at Random”, or ACAR) does not need to be accounted for, whereas irregularity that is associated with the outcome of interest should be considered in the analysis. Irregularity that results in an assessment process that is conditionally independent of the outcome at any given time conditionally on previously observed data (termed “Assessment at Random”, or AAR) can be handled through inverse-intensity weighting. Irregularity that results in an assessment process that is dependent on the outcome at any given time (termed “Assessment Not at Random”, or ANAR) is best handled through sensitivity analysis, for which methods are currently being developed. Specific cases of ANAR, when assessment and outcome processes are conditionally independent given random effects, can be handled through semi-parametric joint models.</p>
<p>Given specific assumptions about the possible nature of AAR, it is possible to examine whether there is evidence against ACAR. Most commonly, an analyst specifies a proportional intensity model for the assessment times given previously observed covariates; intensity rate ratios that differ from 1 provide evidence against ACAR. The function iiw.weights can help you model the assessment intensity, assuming a proportional rates model. The example below uses data from the Phenobarb dataset in the MEMSS package and shows that serum concentration of phenobarbital at the last assessment is associated with subsequent assessment intensity, suggesting that the ACAR assumption is not tenable.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/iiw.weights.html">iiw.weights</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time.lag</span>,<span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu">cluster</span><span class="op">(</span><span class="va">Subject</span><span class="op">)</span>,id<span class="op">=</span><span class="st">"Subject"</span>,time<span class="op">=</span><span class="st">"time"</span>,event<span class="op">=</span><span class="st">"event"</span>,data<span class="op">=</span><span class="va">data</span>,</span>
<span>      invariant<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Subject"</span>,<span class="st">"Wt"</span><span class="op">)</span>,lagvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"conc"</span><span class="op">)</span>,maxfu<span class="op">=</span><span class="fl">16</span><span class="op">*</span><span class="fl">24</span>,lagfirst<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,first<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">i</span><span class="op">$</span><span class="va">m</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; coxph(formula = Surv(time.lag, time, event) ~ I(conc.lag &gt; 0 &amp; </span></span>
<span><span class="co">#&gt;     conc.lag &lt;= 20) + I(conc.lag &gt; 20 &amp; conc.lag &lt;= 30) + I(conc.lag &gt; </span></span>
<span><span class="co">#&gt;     30), data = datacox, cluster = Subject)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                           coef exp(coef) se(coef) robust se</span></span>
<span><span class="co">#&gt; I(conc.lag &gt; 0 &amp; conc.lag &lt;= 20)TRUE  -2.27453   0.10284  0.33148   0.40497</span></span>
<span><span class="co">#&gt; I(conc.lag &gt; 20 &amp; conc.lag &lt;= 30)TRUE -2.67331   0.06902  0.33681   0.37398</span></span>
<span><span class="co">#&gt; I(conc.lag &gt; 30)TRUE                  -2.99982   0.04980  0.42794   0.46762</span></span>
<span><span class="co">#&gt;                                            z        p</span></span>
<span><span class="co">#&gt; I(conc.lag &gt; 0 &amp; conc.lag &lt;= 20)TRUE  -5.617 1.95e-08</span></span>
<span><span class="co">#&gt; I(conc.lag &gt; 20 &amp; conc.lag &lt;= 30)TRUE -7.148 8.79e-13</span></span>
<span><span class="co">#&gt; I(conc.lag &gt; 30)TRUE                  -6.415 1.41e-10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Likelihood ratio test=69.47  on 3 df, p=5.542e-15</span></span>
<span><span class="co">#&gt; n= 213, number of events= 154</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="accounting-for-irregularity-when-assuming-assessment-at-random">Accounting for irregularity when assuming Assessment At Random<a class="anchor" aria-label="anchor" href="#accounting-for-irregularity-when-assuming-assessment-at-random"></a>
</h2>
<p>Inverse-intensity weighted GEEs are a popular way to account for AAR. These can be fitted using the iiwgee function</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iiwgee</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/iiwgee.html">iiwgee</a></span><span class="op">(</span><span class="va">conc</span> <span class="op">~</span> <span class="va">time</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,<span class="fu">Surv</span><span class="op">(</span><span class="va">time.lag</span>,<span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span><span class="fu">cluster</span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span>        formulanull<span class="op">=</span><span class="cn">NULL</span>,id<span class="op">=</span><span class="st">"id"</span>,time<span class="op">=</span><span class="st">"time"</span>,event<span class="op">=</span><span class="st">"event"</span>,data<span class="op">=</span><span class="va">data</span>,</span>
<span>        invariant<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"Wt"</span><span class="op">)</span>,lagvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"conc"</span><span class="op">)</span>,maxfu<span class="op">=</span><span class="fl">16</span><span class="op">*</span><span class="fl">24</span>,lagfirst<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,first<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">iiwgee</span><span class="op">$</span><span class="va">geefit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; geeglm(formula = formulagee, family = family, data = data, weights = useweight, </span></span>
<span><span class="co">#&gt;     id = iddup, corstr = "independence")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate    Std.err    Wald Pr(&gt;|W|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.912e+01  1.268e+00 227.512  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; time         1.060e-01  2.571e-02  16.988 3.76e-05 ***</span></span>
<span><span class="co">#&gt; I(time^3)   -1.469e-06  2.079e-07  49.917 1.60e-12 ***</span></span>
<span><span class="co">#&gt; log(time)    7.501e-01  7.583e-01   0.978    0.323    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correlation structure = independence </span></span>
<span><span class="co">#&gt; Estimated Scale Parameters:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Estimate Std.err</span></span>
<span><span class="co">#&gt; (Intercept)    57.87   27.08</span></span>
<span><span class="co">#&gt; Number of clusters:   59  Maximum cluster size: 6</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="alternative-approaches">Alternative approaches<a class="anchor" aria-label="anchor" href="#alternative-approaches"></a>
</h2>
<p>Multiple outputation is similar to weighting; in each “outputted” dataset observations are selected with probability inversely proportional to the observation intensity. Multiple outputation is thus particularly useful when you want to implement an analytic model that does not permit weighting (for example, a GLMM). The package include the functions outputation and mo for implementing multiple outputation.</p>
<p>If you want to assume the specific case of ANAR that arises when assessment and outcome processes are conditionally independent given random effects, semi-parametric joint models can be used. The IrregLong package includes a function for fitting the Liang semi-parametric joint model.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=IrregLong" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing IrregLong</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://lab.research.sickkids.ca/pullenayegum/" class="external-link">Eleanor Pullenayegum</a> <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=IrregLong" class="external-link"><img src="https://www.r-pkg.org/badges/version/IrregLong" alt="CRAN status"></a></li>
<li><a href="https://github.com/epullenayegum/IrregLong/actions" class="external-link"><img src="https://github.com/epullenayegum/IrregLong/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://lab.research.sickkids.ca/pullenayegum/" class="external-link">Eleanor Pullenayegum</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
