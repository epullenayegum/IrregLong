<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Since the vector of weights is ordered on id and time, if you intend to merge these weights onto your original dataset it is highly recommended that you sort the data before running iiw.weights"><title>Compute inverse-intensity weights. — iiw.weights • IrregLong</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute inverse-intensity weights. — iiw.weights"><meta property="og:description" content="Since the vector of weights is ordered on id and time, if you intend to merge these weights onto your original dataset it is highly recommended that you sort the data before running iiw.weights"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-inverse navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">IrregLong</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Irreglong-vignette.html">Analysis of longitudinal data with irregular observation times</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compute inverse-intensity weights.</h1>
      
      <div class="d-none name"><code>iiw.weights.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Since the vector of weights is ordered on id and time, if you intend to merge these weights onto your original dataset it is highly recommended that you sort the data before running iiw.weights</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">iiw.weights</span><span class="op">(</span>
  <span class="va">formulaph</span>,
  formulanull <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">data</span>,
  <span class="va">id</span>,
  <span class="va">time</span>,
  <span class="va">event</span>,
  <span class="va">lagvars</span>,
  invariant <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">maxfu</span>,
  lagfirst <span class="op">=</span> <span class="va">lagfirst</span>,
  <span class="va">first</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formulaph</dt>
<dd><p>the formula for the proportional hazards model for the visit intensity that will be used to derive inverse-intensity weights. The formula should usually use the counting process format (i.e. Surv(start,stop,event)). If a frailty model is used, the cluster(id) term should appear before other covariates</p></dd>
<dt>formulanull</dt>
<dd><p>if stabilised weights are to be used, the formula for the null model used to stabilise the weights</p></dd>
<dt>data</dt>
<dd><p>data frame containing the variables in the model</p></dd>
<dt>id</dt>
<dd><p>character string indicating which column of the data identifies subjects</p></dd>
<dt>time</dt>
<dd><p>character string indicating which column of the data contains the time at which the visit occurred</p></dd>
<dt>event</dt>
<dd><p>character string indicating which column of the data indicates whether or not a visit occurred. If every row corresponds to a visit, then this column will consist entirely of ones</p></dd>
<dt>lagvars</dt>
<dd><p>a vector of variable names corresponding to variables which need to be lagged by one visit to fit the visit intensity model. Typically time will be one of these variables. The function will internally add columns to the data containing the values of the lagged variables from the previous visit. Values of lagged variables for a subject's first visit will be set to NA. To access these variables in specifying the proportional hazards formulae, add ".lag" to the variable you wish to lag. For example, if time is the variable for time, time.lag is the time of the previous visit</p></dd>
<dt>invariant</dt>
<dd><p>a vector of variable names corresponding to variables in data that are time-invariant. It is not necessary to list every such variable, just those that are invariant and also included in the proportional hazards model</p></dd>
<dt>maxfu</dt>
<dd><p>the maximum follow-up time(s). If everyone is followed for the same length of time, this can be given as a single value. If individuals have different follow-up times, maxfu should have the same number of elements as there are rows of data</p></dd>
<dt>lagfirst</dt>
<dd><p>A vector giving the value of each lagged variable for the first time within each subject. This is helpful if, for example, time is the variable to be lagged and you know that all subjects entered the study at time zero</p></dd>
<dt>first</dt>
<dd><p>logical variable. If TRUE, the first observation for each individual is assigned an intensity of 1. This is appropriate if the first visit is a baseline visit at which recruitment to the study occurred; in this case the baseline visit is observed with probability 1.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a vector of inverse-intensity weights, ordered on id then time</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Given longitudinal data with irregular visit times, fit a Cox proportional hazards model for the visit intensity, then use it to compute inverse-intensity weights</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Lin H, Scharfstein DO, Rosenheck RA. Analysis of Longitudinal data with Irregular, Informative Follow-up. Journal of the Royal Statistical Society, Series B (2004), 66:791-813</p></li>
<li><p>Buzkova P, Lumley T. Longitudinal data analysis for generalized linear models with follow-up dependent on outcome-related variables. The Canadian Journal of Statistics 2007; 35:485-500.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other iiw: 
<code><a href="iiwgee.html">iiwgee</a>()</code>,
<code><a href="iiw.html">iiw</a>()</code></p>
<p>Other iiw: 
<code><a href="iiwgee.html">iiwgee</a>()</code>,
<code><a href="iiw.html">iiw</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="external-link">nlme</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Phenobarb</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">geepack</span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">Phenobarb</span><span class="op">$</span><span class="va">event</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Phenobarb</span><span class="op">$</span><span class="va">conc</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">Phenobarb</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">event</span><span class="op">==</span><span class="fl">1</span>,<span class="op">]</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">Subject</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">time</span><span class="op">&lt;</span><span class="fl">16</span><span class="op">*</span><span class="fl">24</span>,<span class="op">]</span></span>
<span class="r-in"><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu">iiw.weights</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time.lag</span>,<span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">30</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span class="r-in">id<span class="op">=</span><span class="st">"id"</span>,time<span class="op">=</span><span class="st">"time"</span>,event<span class="op">=</span><span class="st">"event"</span>,data<span class="op">=</span><span class="va">data</span>,</span>
<span class="r-in">invariant<span class="op">=</span><span class="st">"id"</span>,lagvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"conc"</span><span class="op">)</span>,maxfu<span class="op">=</span><span class="fl">16</span><span class="op">*</span><span class="fl">24</span>,lagfirst<span class="op">=</span><span class="fl">0</span>,first<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">data</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">$</span><span class="va">iiw.weight</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">i</span><span class="op">$</span><span class="va">m</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> coxph(formula = Surv(time.lag, time, event) ~ I(conc.lag &gt; 0 &amp; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     conc.lag &lt;= 20) + I(conc.lag &gt; 20 &amp; conc.lag &lt;= 30) + I(conc.lag &gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30), data = datacox, cluster = id)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n= 154, number of events= 95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    (59 observations deleted due to missingness)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                         coef exp(coef) se(coef) robust se     z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 0 &amp; conc.lag &lt;= 20)TRUE  0.7379    2.0915   0.3398    0.3066 2.406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 20 &amp; conc.lag &lt;= 30)TRUE 0.3261    1.3856   0.3004    0.2851 1.144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 30)TRUE                      NA        NA   0.0000    0.0000    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       Pr(&gt;|z|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 0 &amp; conc.lag &lt;= 20)TRUE    0.0161 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 20 &amp; conc.lag &lt;= 30)TRUE   0.2527  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 30)TRUE                        NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                       exp(coef) exp(-coef) lower .95 upper .95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 0 &amp; conc.lag &lt;= 20)TRUE      2.091     0.4781    1.1467     3.815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 20 &amp; conc.lag &lt;= 30)TRUE     1.386     0.7217    0.7924     2.423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(conc.lag &gt; 30)TRUE                         NA         NA        NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Concordance= 0.559  (se = 0.022 )</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood ratio test= 5.12  on 2 df,   p=0.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wald test            = 6.69  on 2 df,   p=0.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Score (logrank) test = 5.31  on 2 df,   p=0.07,   Robust = 7.18  p=0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (Note: the likelihood ratio and score tests assume independence of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      observations within a cluster, the Wald and robust score tests do not).</span>
<span class="r-in"><span class="co"># can use to fit a weighted GEE</span></span>
<span class="r-in"><span class="va">mw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geepack/man/geeglm.html" class="external-link">geeglm</a></span><span class="op">(</span><span class="va">conc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> , id<span class="op">=</span><span class="va">Subject</span>, data<span class="op">=</span><span class="va">data</span>, weights<span class="op">=</span><span class="va">weight</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mw</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geeglm(formula = conc ~ I(time^3) + log(time), data = data, weights = weight, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id = Subject)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Estimate    Std.err   Wald Pr(&gt;|W|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  1.684e+01  1.049e+00 257.82   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(time^3)   -6.410e-07  6.112e-08 109.99   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(time)    3.064e+00  3.588e-01  72.89   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation structure = independence </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Scale Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    47.31   14.66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of clusters:   59  Maximum cluster size: 6 </span>
<span class="r-in"><span class="co"># agrees with results through the single command iiwgee</span></span>
<span class="r-in"><span class="va">miiwgee</span> <span class="op">&lt;-</span> <span class="fu"><a href="iiwgee.html">iiwgee</a></span><span class="op">(</span><span class="va">conc</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">time</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time.lag</span>,<span class="va">time</span>,<span class="va">event</span><span class="op">)</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">0</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">20</span> <span class="op">&amp;</span> <span class="va">conc.lag</span><span class="op">&lt;=</span><span class="fl">30</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">conc.lag</span><span class="op">&gt;</span><span class="fl">30</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/cluster.html" class="external-link">cluster</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span>,</span>
<span class="r-in">id<span class="op">=</span><span class="st">"id"</span>,time<span class="op">=</span><span class="st">"time"</span>,event<span class="op">=</span><span class="st">"event"</span>,data<span class="op">=</span><span class="va">data</span>,</span>
<span class="r-in">invariant<span class="op">=</span><span class="st">"id"</span>,lagvars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>,<span class="st">"conc"</span><span class="op">)</span>,maxfu<span class="op">=</span><span class="fl">16</span><span class="op">*</span><span class="fl">24</span>,lagfirst<span class="op">=</span><span class="fl">0</span>,first<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">miiwgee</span><span class="op">$</span><span class="va">geefit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> geeglm(formula = formulagee, family = family, data = data, weights = useweight, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     id = iddup, corstr = "independence")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Estimate   Std.err  Wald Pr(&gt;|W|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  1.65e+01  1.02e+00 262.0   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I(time^3)   -6.63e-07  7.65e-08  75.2   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log(time)    3.25e+00  4.05e-01  64.4    1e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation structure = independence </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Scale Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Estimate Std.err</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)     49.1      17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of clusters:   59  Maximum cluster size: 6 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://lab.research.sickkids.ca/pullenayegum/" class="external-link">Eleanor Pullenayegum</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

